\documentclass{beamer}
\usepackage[utf8]{inputenc}
\beamertemplateshadingbackground{red!10}{blue!10}
%\usepackage{fancybox}
\usepackage{epsfig}
\usepackage{verbatim}
\usepackage{url}
%\usepackage{graphics}
%\usepackage{xcolor}
\usepackage{fancybox}
\usepackage{moreverb}
%\usepackage[all]{xy}
\usepackage{listings}
\usepackage{filecontents}
\usepackage{graphicx}

\lstset{
  language=Lisp,
  basicstyle=\scriptsize\ttfamily,
  keywordstyle={},
  commentstyle={},
  stringstyle={}}

\def\inputfig#1{\input #1}
\def\inputeps#1{\includegraphics{#1}}
\def\inputtex#1{\input #1}

\inputtex{logos.tex}

%\definecolor{ORANGE}{named}{Orange}

\definecolor{GREEN}{rgb}{0,0.8,0}
\definecolor{YELLOW}{rgb}{1,1,0}
\definecolor{ORANGE}{rgb}{1,0.647,0}
\definecolor{PURPLE}{rgb}{0.627,0.126,0.941}
\definecolor{PURPLE}{named}{purple}
\definecolor{PINK}{rgb}{1,0.412,0.706}
\definecolor{WHEAT}{rgb}{1,0.8,0.6}
\definecolor{BLUE}{rgb}{0,0,1}
\definecolor{GRAY}{named}{gray}
\definecolor{CYAN}{named}{cyan}

\newcommand{\orchid}[1]{\textcolor{Orchid}{#1}}
\newcommand{\defun}[1]{\orchid{#1}}

\newcommand{\BROWN}[1]{\textcolor{BROWN}{#1}}
\newcommand{\RED}[1]{\textcolor{red}{#1}}
\newcommand{\YELLOW}[1]{\textcolor{YELLOW}{#1}}
\newcommand{\PINK}[1]{\textcolor{PINK}{#1}}
\newcommand{\WHEAT}[1]{\textcolor{wheat}{#1}}
\newcommand{\GREEN}[1]{\textcolor{GREEN}{#1}}
\newcommand{\PURPLE}[1]{\textcolor{PURPLE}{#1}}
\newcommand{\BLACK}[1]{\textcolor{black}{#1}}
\newcommand{\WHITE}[1]{\textcolor{WHITE}{#1}}
\newcommand{\MAGENTA}[1]{\textcolor{MAGENTA}{#1}}
\newcommand{\ORANGE}[1]{\textcolor{ORANGE}{#1}}
\newcommand{\BLUE}[1]{\textcolor{BLUE}{#1}}
\newcommand{\GRAY}[1]{\textcolor{gray}{#1}}
\newcommand{\CYAN}[1]{\textcolor{cyan }{#1}}

\newcommand{\reference}[2]{\textcolor{PINK}{[#1~#2]}}
%\newcommand{\vect}[1]{\stackrel{\rightarrow}{#1}}

% Use some nice templates
\beamertemplatetransparentcovereddynamic

\newcommand{\A}{{\mathbb A}}
\newcommand{\degr}{\mathrm{deg}}

\title{Call-site optimization for \commonlisp{}}

\author{Robert Strandh}
\institute{
LaBRI, University of Bordeaux
}
\date{April, 2021}

%\inputtex{macros.tex}


\begin{document}
\frame{
\titlepage
\vfill
\small{European Lisp Symposium, Online Everywhere \hfill ELS2021}
}

\setbeamertemplate{footline}{
\vspace{-1em}
\hspace*{1ex}{~} \GRAY{\insertframenumber/\inserttotalframenumber}
}

\frame{
\frametitle{Context: The \sicl{} project}

https://github.com/robert-strandh/SICL

Several objectives:

\begin{itemize}
\item Create high-quality \emph{modules} for implementors of
  \commonlisp{} systems.
\item Improve existing techniques with respect to algorithms and data
  structures where possible.
\item Improve readability and maintainability of code.
\item Improve documentation.
\item Ultimately, create a new implementation based on these modules.
\end{itemize}
}

\frame{
  \frametitle{Context for this work}
  Cost of function calls in \commonlisp{}:
  \begin{itemize}
  \item Late binding.
  \item Optional parameters and keyword parameters.
  \item Callee must often check types of arguments.
  \item Arguments must be boxed.
  \item Generic functions can be dynamically updated.
  \item Multiple return values complicate caller.
  \end{itemize}
}

\frame{
  \frametitle{Late binding}
  \begin{itemize}
  \item Usually handled by an indirection through a symbol.
  \item In SICL, handled by an indirection through a \emph{function cell} in
    a first-class global environment.
  \item Late binding is no longer respected in the presence of compiler
    macros or inlining.
  \end{itemize}
}

\frame{
  \frametitle{Optional parameters and keyword parameters}
  \begin{itemize}
  \item Callee must at least check the argument count.
  \item With optional parameters, a conditional branch is required.
  \item Keyword parameters require iterating over remaining arguments.
  \end{itemize}
  \vskip 0.25cm
  Mitigated by the use of compiler macros.  But then late binding is
  no longer respected.
}

\frame{
  \frametitle{Callee must check types of arguments}
  Necessary if specific types are required to fulfill contract.
  \vskip 0.25cm
  Mitigated by inlining.  But then late binding is no longer
  respected.
}

\frame{
  \frametitle{Arguments must be boxed}
  \vskip 0.25cm
  Mitigated by multiple entry points for each function.
  \vskip 0.25cm
  Used by Allegreo \commonlisp{}.
  \vskip 0.25cm
  A similar technique is used for (a single) unbox return value.
}

\frame{
  \frametitle{Generic functions can be dynamically updated}
  \vskip 0.25cm
  Callers can make no assumption about applicable methods.
}

\frame{
  \frametitle{Multiple return values complicate caller}
  \vskip 0.25cm
  Mitigated by recognizing that most callers require at most a single
  return value.
  \vskip 0.25cm
  Callee can then always set value in one register.
}

\frame{
  \frametitle{Current work}
  \vskip 0.25cm
  We propose a general technique for call-site-optimization that can
  handle many of these issues.
}

\frame[containsverbatim]{
\frametitle{blabla}
\begin{verbatim}
(defgeneric foo (x)
  (:method-combination and :most-specific-last))
\end{verbatim}
}

\frame{
\frametitle{Previous work}
We investigated:
\begin{itemize}
\item cmucl
\item Steel Bank Common Lisp (SBCL)
\item Clasp
\item Allegro
\end{itemize}
}

\frame{
\frametitle{Our technique}
\vskip 0.25cm
%% \begin{figure}
%% \begin{center}
%% \inputfig{fig-method-combinations.pdf_t}
%% \end{center}
%% \end{figure}
}

\frame{
\frametitle{Future work}
blabla
\vskip 0.25cm
blabla
}

\frame{
  \frametitle{Acknowledgments}

We would like to thank...
}

\frame{
\frametitle{Thank you}
}

%% \frame{\tableofcontents}
%% \bibliography{references}
%% \bibliographystyle{alpha}

\end{document}
